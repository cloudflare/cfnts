all: &all
  test:
    builddeps:
      - rust=1.31.0-1
      - cargo-to-teamcity
      - pkg-config
    post-cache:
      - cargo test | cargo-to-teamcity
  build:
    builddeps:
      - rust=1.31.0-1
      - cargo-to-teamcity
      - pkg-config
      - cargo-deb
    post-cache:
      - make cf-package
  build-compose:
    builddeps:
      - rust=1.31.0-1
      - cargo-to-teamcity
      - pkg-config
    post-cache:
      - cargo build | cargo-to-teamcity
  compose:
    files:
      - docker-compose.yaml
    up-args: ["--build", "--force-recreate", "--abort-on-container-exit"]
jessie: *all
stretch: *all
